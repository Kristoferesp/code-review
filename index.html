<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Financeiro + Metas</title>
    <style>
        :root {
            --primary: #3b82f6;
            --success: #2ecc71;
            --danger: #e74c3c;
            --dark: #1f2937;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }

        body { 
            background-color: #f3f4f6; 
            display: flex; flex-direction: column; align-items: center; 
            padding: 20px; min-height: 100vh; transition: background 0.3s;
        }

        .container { background: white; width: 100%; max-width: 600px; padding: 25px; border-radius: 12px; box-shadow: 0 10px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }

        h2, h3 { color: var(--dark); margin-bottom: 15px; text-align: center; }

        /* Temas */
        .theme-selector { margin-bottom: 15px; display: flex; align-items: center; gap: 10px; background: #fff; padding: 8px 15px; border-radius: 20px; font-size: 14px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* Dashboard */
        .dashboard { display: flex; justify-content: space-between; margin-bottom: 25px; gap: 10px; }
        .card { flex: 1; text-align: center; padding: 15px; border-radius: 8px; border: 1px solid #eee; }
        .card h4 { font-size: 11px; text-transform: uppercase; color: #777; }
        .money-plus { color: var(--success); font-weight: bold; }
        .money-minus { color: var(--danger); font-weight: bold; }

        /* Listas */
        .list { list-style: none; margin-bottom: 20px; max-height: 150px; overflow-y: auto; }
        .list li { background: #f9f9f9; border: 1px solid #eee; padding: 10px; margin-bottom: 5px; display: flex; justify-content: space-between; border-radius: 5px; }
        .list li.plus { border-left: 5px solid var(--success); }
        .list li.minus { border-left: 5px solid var(--danger); }

        /* Metas */
        .goal-item { background: #fff; border: 1px solid #ddd; padding: 15px; border-radius: 8px; margin-bottom: 10px; }
        .goal-info { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: bold; font-size: 14px; }
        .progress-bar { background: #eee; border-radius: 10px; height: 12px; width: 100%; overflow: hidden; }
        .progress-fill { background: var(--primary); height: 100%; width: 0%; transition: width 0.5s; }

        /* Forms */
        .form-group { margin-bottom: 10px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; transition: opacity 0.2s; }
        .btn-add { background: var(--primary); margin-top: 5px; }
        .btn-goal { background: var(--dark); margin-top: 5px; }
        .btn:hover { opacity: 0.8; }
        .delete-btn { background: none; border: none; color: var(--danger); cursor: pointer; font-weight: bold; }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div class="theme-selector">
        <label>üé® Cor de Fundo:</label>
        <input type="color" id="bg-picker" value="#f3f4f6">
    </div>

    <div class="container">
        <h2>üí∞ Simulador Financeiro</h2>
        
        <div class="dashboard">
            <div class="card"><h4>Entradas</h4><p id="inc" class="money-plus">R$ 0</p></div>
            <div class="card"><h4>Sa√≠das</h4><p id="exp" class="money-minus">R$ 0</p></div>
            <div class="card"><h4>Saldo</h4><p id="bal">R$ 0</p></div>
        </div>

        <div class="grid">
            <!-- Coluna 1: Transa√ß√µes -->
            <div>
                <h3>Transa√ß√µes</h3>
                <ul id="trans-list" class="list"></ul>
                <form id="trans-form">
                    <input type="text" id="t-text" placeholder="Descri√ß√£o" required style="margin-bottom:5px">
                    <input type="number" id="t-amount" placeholder="Valor" step="0.01" required style="margin-bottom:5px">
                    <select id="t-type" style="margin-bottom:5px">
                        <option value="receita">Receita (+)</option>
                        <option value="despesa">Despesa (-)</option>
                    </select>
                    <button class="btn btn-add">Adicionar</button>
                </form>
            </div>

            <!-- Coluna 2: Metas -->
            <div>
                <h3>üéØ Metas</h3>
                <div id="goals-container"></div>
                <form id="goal-form" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
                    <input type="text" id="g-name" placeholder="Nome da Meta (Ex: Carro)" required style="margin-bottom:5px">
                    <input type="number" id="g-target" placeholder="Valor Alvo (R$)" required style="margin-bottom:5px">
                    <button class="btn btn-goal">Criar Meta</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Elementos
        const transList = document.getElementById('trans-list');
        const goalsContainer = document.getElementById('goals-container');
        const balEl = document.getElementById('bal');
        const incEl = document.getElementById('inc');
        const expEl = document.getElementById('exp');

        // Estado
        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let goals = JSON.parse(localStorage.getItem('goals')) || [];

        // --- TEMA ---
        const bgPicker = document.getElementById('bg-picker');
        bgPicker.value = localStorage.getItem('bgColor') || '#f3f4f6';
        document.body.style.backgroundColor = bgPicker.value;
        bgPicker.oninput = (e) => {
            document.body.style.backgroundColor = e.target.value;
            localStorage.setItem('bgColor', e.target.value);
        };

        // --- TRANSA√á√ïES ---
        document.getElementById('trans-form').onsubmit = (e) => {
            e.preventDefault();
            const text = document.getElementById('t-text').value;
            const amt = document.getElementById('t-amount').value;
            const type = document.getElementById('t-type').value;
            
            transactions.push({
                id: Date.now(),
                text,
                amount: type === 'despesa' ? -Math.abs(amt) : Math.abs(amt)
            });
            update();
            e.target.reset();
        };

        // --- METAS ---
        document.getElementById('goal-form').onsubmit = (e) => {
            e.preventDefault();
            goals.push({
                id: Date.now(),
                name: document.getElementById('g-name').value,
                target: parseFloat(document.getElementById('g-target').value)
            });
            update();
            e.target.reset();
        };

        function removeTrans(id) { transactions = transactions.filter(t => t.id !== id); update(); }
        function removeGoal(id) { goals = goals.filter(g => g.id !== id); update(); }

        // --- ATUALIZA√á√ÉO GERAL ---
        function update() {
            localStorage.setItem('transactions', JSON.stringify(transactions));
            localStorage.setItem('goals', JSON.stringify(goals));

            // Calcular Saldo
            const amounts = transactions.map(t => t.amount);
            const total = amounts.reduce((acc, i) => acc + i, 0);
            const inc = amounts.filter(i => i > 0).reduce((acc, i) => acc + i, 0);
            const exp = amounts.filter(i => i < 0).reduce((acc, i) => acc + i, 0);

            balEl.innerText = total.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
            incEl.innerText = inc.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
            expEl.innerText = Math.abs(exp).toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});

            // Render Transa√ß√µes
            transList.innerHTML = '';
            transactions.forEach(t => {
                const li = document.createElement('li');
                li.className = t.amount < 0 ? 'minus' : 'plus';
                li.innerHTML = `${t.text} <span>${t.amount.toLocaleString('pt-BR')} <button class="delete-btn" onclick="removeTrans(${t.id})">x</button></span>`;
                transList.appendChild(li);
            });

            // Render Metas
            goalsContainer.innerHTML = '';
            goals.forEach(g => {
                const percent = Math.min((total / g.target) * 100, 100).toFixed(1);
                const displayPercent = total > 0 ? (percent < 0 ? 0 : percent) : 0;
                
                const div = document.createElement('div');
                div.className = 'goal-item';
                div.innerHTML = `
                    <div class="goal-info">
                        <span>${g.name} <button class="delete-btn" onclick="removeGoal(${g.id})">üóëÔ∏è</button></span>
                        <span>${displayPercent}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${displayPercent}%; background: ${displayPercent >= 100 ? '#2ecc71' : '#3b82f6'}"></div>
                    </div>
                    <small style="display:block; margin-top:5px; color:#666">Alvo: R$ ${g.target.toLocaleString('pt-BR')}</small>
                `;
                goalsContainer.appendChild(div);
            });
        }

        update();
    </script>
</body>
</html>